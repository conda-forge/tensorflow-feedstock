From 613bcf9f92750bebf88b5f119da8bce83acb4b47 Mon Sep 17 00:00:00 2001
From: Mike Kruskal <mkruskal@google.com>
Date: Thu, 3 Feb 2022 13:11:04 -0800
Subject: [PATCH] Remove dependency on implementation of
 RepeatedField::iterator

PiperOrigin-RevId: 426221185
Change-Id: I19d268376e1d7a211d64b63b14e5423da979b275
---
 tensorflow/core/framework/tensor.cc | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)

diff --git a/tensorflow/core/framework/tensor.cc b/tensorflow/core/framework/tensor.cc
index c7a08ee080804..3a0a8f6cef4d9 100644
--- a/tensorflow/core/framework/tensor.cc
+++ b/tensorflow/core/framework/tensor.cc
@@ -340,8 +340,9 @@ PROTO_TRAITS(quint16, int32, int);
 
 template <>
 struct ProtoHelper<int64_t> {
-  static const int64_t* Begin(const TensorProto& proto) {
-    return reinterpret_cast<const int64_t*>(proto.int64_val().begin());
+  static protobuf::RepeatedField<int64_t>::const_iterator Begin(
+      const TensorProto& proto) {
+    return proto.int64_val().begin();
   }
   static size_t NumElements(const TensorProto& proto) {
     return proto.int64_val().size();
@@ -354,8 +355,9 @@ struct ProtoHelper<int64_t> {
 
 template <>
 struct ProtoHelper<uint64> {
-  static const uint64* Begin(const TensorProto& proto) {
-    return reinterpret_cast<const uint64*>(proto.uint64_val().begin());
+  static protobuf::RepeatedField<uint64_t>::const_iterator Begin(
+      const TensorProto& proto) {
+    return proto.uint64_val().begin();
   }
   static size_t NumElements(const TensorProto& proto) {
     return proto.uint64_val().size();
