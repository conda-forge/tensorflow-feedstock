From 7b72d2d4f7d71698e5e0e5237f2229ca226d6d6e Mon Sep 17 00:00:00 2001
From: aravindhbalaji1985 <aravindhbalaji@gmail.com>
Date: Mon, 25 Aug 2025 15:15:14 -0700
Subject: [PATCH 33/34] Support for TFv2.20 to compile with CUDA v12.9.1

---
 tensorflow/core/kernels/gpu_prim.h | 7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)

diff --git a/tensorflow/core/kernels/gpu_prim.h b/tensorflow/core/kernels/gpu_prim.h
index f80bd54d4a1..f3c4e9b90c1 100644
--- a/tensorflow/core/kernels/gpu_prim.h
+++ b/tensorflow/core/kernels/gpu_prim.h
@@ -37,8 +37,8 @@ namespace gpuprim = ::cub;
 
 // Required for sorting Eigen::half and bfloat16.
 namespace cub {
-template <>
-__device__ __forceinline__ void ThreadStoreVolatilePtr<Eigen::half>(
+
+__device__ __forceinline__ void ThreadStoreVolatilePtr(
     Eigen::half *ptr, Eigen::half val, Int2Type<true> /*is_primitive*/) {
   *reinterpret_cast<volatile uint16_t *>(ptr) =
       Eigen::numext::bit_cast<uint16_t>(val);
@@ -50,8 +50,7 @@ __device__ __forceinline__ Eigen::half ThreadLoadVolatilePointer(
   return Eigen::numext::bit_cast<Eigen::half>(result);
 }
 
-template <>
-__device__ __forceinline__ void ThreadStoreVolatilePtr<Eigen::bfloat16>(
+__device__ __forceinline__ void ThreadStoreVolatilePtr(
     Eigen::bfloat16 *ptr, Eigen::bfloat16 val,
     Int2Type<true> /*is_primitive*/) {
   *reinterpret_cast<volatile uint16_t *>(ptr) =
-- 
2.47.1

